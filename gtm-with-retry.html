<script>
// WAIT FOR READY APPROACH
(function() {
  // Check if already loaded
  if (window.SentientIQ_loaded) return;
  window.SentientIQ_loaded = true;

  // Store in localStorage
  localStorage.setItem('tenantId', 'sidk');
  localStorage.setItem('apiKey', 'sq_live_sidk_test');

  // Load detection FIRST
  var detect = document.createElement('script');
  detect.src = 'https://sentientiq.ai/detect-v4.js?tenant=sidk&key=sq_live_sidk_test';
  detect.onload = function() {
    console.log('[SentientIQ] Detection loaded');

    // Set emotions property to satisfy interventions check
    if (window.SentientIQ && !window.SentientIQ.emotions) {
      window.SentientIQ.emotions = window.SentientIQ.getEmotionHistory || function() { return []; };
    }

    // Wait a bit for full initialization then load interventions
    setTimeout(function() {
      var interventions = document.createElement('script');
      interventions.src = 'https://sentientiq.ai/interventions-v4.js?tenant=sidk&key=sq_live_sidk_test';
      interventions.onload = function() {
        console.log('[SentientIQ] Interventions loaded');
        console.log('[SentientIQ] System fully initialized');
      };
      interventions.onerror = function() {
        console.error('[SentientIQ] Failed to load interventions');
      };
      document.head.appendChild(interventions);
    }, 100);
  };
  document.head.appendChild(detect);
})();
</script>