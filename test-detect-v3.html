<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SentientIQ v3 Detection Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .section {
            min-height: 100vh;
            padding: 80px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #hero {
            background: rgba(255, 255, 255, 0.1);
        }

        #features {
            background: rgba(255, 255, 255, 0.15);
        }

        #pricing {
            background: rgba(255, 255, 255, 0.2);
        }

        #contact {
            background: rgba(255, 255, 255, 0.25);
        }

        .emotion-monitor {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 400px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 600px;
            overflow-y: auto;
            z-index: 9999;
        }

        .emotion-event {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }

        .signal-indicator {
            display: inline-block;
            padding: 2px 6px;
            background: rgba(102, 126, 234, 0.3);
            border-radius: 3px;
            margin: 2px;
        }

        .price-card {
            background: white;
            padding: 30px;
            margin: 20px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.3s;
        }

        .price-card:hover {
            transform: translateY(-5px);
        }

        .price {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #764ba2;
        }

        input, textarea {
            padding: 15px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px;
            width: 300px;
        }

        .test-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 9999;
        }

        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <!-- Emotion Monitor -->
    <div class="emotion-monitor">
        <h3>ðŸ§  SentientIQ v3 Monitor</h3>
        <div class="stats">
            <div>Section: <span id="current-section">-</span></div>
            <div>Active Signals: <span id="active-signals">-</span></div>
            <div>Emotions Detected: <span id="emotion-count">0</span></div>
        </div>
        <div id="emotion-log"></div>
    </div>

    <!-- Test Controls -->
    <div class="test-controls">
        <h4>Test Scenarios</h4>
        <button class="test-button" onclick="simulateRageClick()">Rage Click</button>
        <button class="test-button" onclick="simulatePriceRecoil()">Price Recoil</button>
        <button class="test-button" onclick="simulateConfusion()">Confusion Pattern</button>
        <button class="test-button" onclick="simulateInterest()">Interest Pattern</button>
        <button class="test-button" onclick="clearLog()">Clear Log</button>
    </div>

    <!-- Test Sections -->
    <div id="hero" class="section">
        <h1>Welcome to Test Site</h1>
        <p>Scroll slowly to show interest, quickly to show impatience</p>
        <button>Get Started</button>
    </div>

    <div id="features" class="section">
        <h2>Amazing Features</h2>
        <p>Hover over these items to show evaluation behavior</p>
        <div style="display: flex; gap: 20px; margin-top: 30px;">
            <div class="price-card">
                <h3>Feature 1</h3>
                <p>Click multiple times quickly to trigger rage click</p>
            </div>
            <div class="price-card">
                <h3>Feature 2</h3>
                <p>Hover and move away quickly</p>
            </div>
        </div>
    </div>

    <div id="pricing" class="section">
        <h2>Pricing Plans</h2>
        <p>Mouse over prices and recoil to trigger sticker shock</p>
        <div style="display: flex; gap: 20px; margin-top: 30px;">
            <div class="price-card">
                <h3>Basic</h3>
                <div class="price">$99</div>
                <button>Choose Plan</button>
            </div>
            <div class="price-card">
                <h3>Pro</h3>
                <div class="price">$299</div>
                <button>Choose Plan</button>
            </div>
            <div class="price-card">
                <h3>Enterprise</h3>
                <div class="price">$999</div>
                <button>Choose Plan</button>
            </div>
        </div>
    </div>

    <div id="contact" class="section">
        <h2>Contact Us</h2>
        <p>Start filling form and abandon to trigger abandonment signals</p>
        <form onsubmit="return false;">
            <input type="text" placeholder="Your Name" />
            <input type="email" placeholder="Your Email" />
            <textarea placeholder="Your Message"></textarea>
            <br>
            <button type="submit">Send Message</button>
        </form>
    </div>

    <!-- Load Detection Script -->
    <script src="detect-v3.js" data-api-key="TEST_KEY" data-debug="true"></script>

    <!-- Test Harness -->
    <script>
        let emotionCount = 0;
        const logElement = document.getElementById('emotion-log');

        // Listen for emotions
        window.addEventListener('sentientiq:emotion', (event) => {
            emotionCount++;
            document.getElementById('emotion-count').textContent = emotionCount;

            const emotion = event.detail;
            const logEntry = document.createElement('div');
            logEntry.className = 'emotion-event';
            logEntry.innerHTML = `
                <strong>${emotion.emotion}</strong>
                (${Math.round(emotion.confidence)}% confident)<br>
                Section: ${emotion.section}<br>
                ${emotion.metadata.signals ?
                    'Signals: ' + emotion.metadata.signals.map(s =>
                        `<span class="signal-indicator">${s}</span>`
                    ).join('') : ''}
                <small>${new Date().toLocaleTimeString()}</small>
            `;

            logElement.insertBefore(logEntry, logElement.firstChild);

            // Keep log limited
            if (logElement.children.length > 20) {
                logElement.removeChild(logElement.lastChild);
            }
        });

        // Update current section
        setInterval(() => {
            if (window.SentientIQ) {
                document.getElementById('current-section').textContent =
                    window.SentientIQ.getCurrentSection() || 'unknown';

                const signals = window.SentientIQ.getActiveSignals();
                document.getElementById('active-signals').textContent =
                    signals.length > 0 ? signals.join(', ') : 'none';
            }
        }, 1000);

        // Test functions
        function simulateRageClick() {
            const target = document.querySelector('.price-card');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;

            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    target.click();
                    // Also trigger the internal tracking
                    const event = new MouseEvent('click', {
                        clientX: x + Math.random() * 10,
                        clientY: y + Math.random() * 10,
                        bubbles: true
                    });
                    document.dispatchEvent(event);
                }, i * 150);
            }
        }

        function simulatePriceRecoil() {
            const priceElement = document.querySelector('.price');
            const rect = priceElement.getBoundingClientRect();

            // Simulate mouse moving to price
            const moveEvent = new MouseEvent('mousemove', {
                clientX: rect.left + rect.width / 2,
                clientY: rect.top + rect.height / 2,
                bubbles: true
            });
            document.dispatchEvent(moveEvent);

            // Simulate quick recoil
            setTimeout(() => {
                const recoilEvent = new MouseEvent('mousemove', {
                    clientX: rect.left + rect.width / 2,
                    clientY: rect.top - 200,
                    bubbles: true
                });
                document.dispatchEvent(recoilEvent);
            }, 100);
        }

        function simulateConfusion() {
            let scrollDirection = 1;
            let count = 0;

            const interval = setInterval(() => {
                window.scrollBy(0, scrollDirection * 200);
                scrollDirection *= -1;
                count++;

                if (count > 6) {
                    clearInterval(interval);
                }
            }, 300);
        }

        function simulateInterest() {
            // Slow deliberate scroll
            let position = window.scrollY;
            const target = position + 500;

            const interval = setInterval(() => {
                position += 5;
                window.scrollTo(0, position);

                if (position >= target) {
                    clearInterval(interval);
                }
            }, 50);
        }

        function clearLog() {
            logElement.innerHTML = '';
            emotionCount = 0;
            document.getElementById('emotion-count').textContent = '0';
        }
    </script>
</body>
</html>